build_job:
  image: "gradle:4.7.0-jdk8-alpine"

  stage: build

  script:
  - gradle build

  artifacts:
    paths:
    - ./build/distributions/
    - ./build/maven2/

  only:
  - bleeding

deploy_job:
  image: alpine

  before_script:
  - apk update
  - apk add openssh sshpass lftp

  stage: deploy

  script:
  - ls -al
  - echo "pwd" | sshpass -p $SFTP_PASS sftp -P $SFTP_PORT -o StrictHostKeyChecking=no $SFTP_USER@$SFTP_HOST
  - lftp -e "mirror -R ./build/maven2/ /" -u $SFTP_USER,$SFTP_PASS sftp://$SFTP_HOST:$SFTP_PORT

  only:
  - bleeding
